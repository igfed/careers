!function(){"use strict";var e=function(){return window.location.pathname.indexOf("/fr/")!==-1?"fr":"en"}(),t=(new EventEmitter,function(){function e(){c=$(".ig-form"),r=c.find("form"),s=c.find("form").data("endpoint"),l=c.find("form").data("cancel"),t(),a()}function t(){var e=$(":input, textarea");e.change(function(e){$(this).addClass("dirty")}),$.validator.setDefaults({debug:!0,success:"valid"}),$.validator.addMethod("cdnPostal",function(e,t){return this.optional(t)||e.match(/[a-zA-Z][0-9][a-zA-Z](-| |)[0-9][a-zA-Z][0-9]/)},"Please specify a valid postal code."),r.validate({submitHandler:function(){n()},errorPlacement:function(e,t){$(t).closest(".row").find(".custom-error-location").length?$(t).closest(".row").find(".custom-error-location").append(e):$(t).parent().append(e)},rules:{phone:{required:!0,phoneUS:!0},phone2:{required:!0,phoneUS:!0},postal_code:{required:!0,cdnPostal:!0},firstname:{required:!0,maxlength:100},lastname:{required:!0,maxlength:100},email:{required:!0,maxlength:100},email2:{required:!0,maxlength:100}}}),r.find("button.cancel").on("click",function(){window.location.replace(l)})}function n(e){var t,n;return r.valid()&&(r.removeClass("server-error"),c.addClass("submitting"),t=r.serializeArray(),n=o(t),i(n)),!1}function o(e){return e}function i(e){$.ajax({method:"POST",url:s,data:e}).success(function(e){c.addClass("success"),c.removeClass("submitting")}).error(function(e){r.addClass("server-error"),c.removeClass("submitting"),ScrollMan.to($("#server-error"))})}function a(){$(".toggler").on("click",function(){$(".toggle-content").hide(),$("."+$(this).data("content")).show()})}var s,l,r,c;return{init:e}}()),n=function(){function e(){console.log("Carousel Initialized!"),$("[data-responsive-toggle] button").on("click",function(){$("body").toggleClass("site-header-is-active")}),t()}function t(){var e,t,n;$(".ig-carousel").each(function(o){n=$(this),e=n.data("prevArrowText")?'<button type="button" class="slick-prev"><span class="show-for-sr">'+n.data("prevArrowText")+"</span></button>":'<button type="button" class="slick-prev"><span class="show-for-sr">Previous</span></button>',t=n.data("nextArrowText")?'<button type="button" class="slick-next"><span class="show-for-sr">'+n.data("nextArrowText")+"</span></button>":'<button type="button" class="slick-next"><span class="show-for-sr">Next</span></button>',n.slick({adaptiveHeight:n.data("adaptiveHeight")||!1,arrows:n.data("arrows")||!1,autoPlay:n.data("autoPlay")||!1,dots:n.data("dots")||!1,fade:n.data("fade")||!1,infinite:n.data("infinite")||!1,mobileFirst:!0,nextArrow:t,prevArrow:e,responsive:n.data("responsive")||"",slide:n.data("slide")||"",slidesToScroll:n.data("slideToScroll")||1,slidesToShow:n.data("slidesToShow")||1,speed:n.data("speed")||300})})}return{init:e}}(),o=function(){function e(){t()}function t(){!function(e){e.fn.infoToggle=function(){return this.each(function(){function t(){l.on("click",n),e(window).on("resize",o),i()}function n(){i(),a.toggleClass("active"),window.setTimeout(i)}function o(){r&&s.css({height:"auto"})}function i(){var e;a.hasClass("active")?(e=s[0].scrollHeight,r=!0):(e=0,r=!1),s.css({height:e}),c&&s.attr("aria-hidden",!r)}var a=e(this),s=a.find(".info-toggle-content"),l=a.find(".info-toggle-trigger"),r=!1,c="true"===a.attr("info-toggle-aria");t()}),this}}(jQuery),function(e){e.fn.circleAnimation=function(t){return this.each(function(){function n(e){e=e?e:0,o(),i.lineWidth=r,i.beginPath(),i.arc(l,l,d,-h,f*-Math.min(e,t/100)-h,!0),i.stroke(),i.lineWidth=c,i.beginPath(),i.arc(l,l,d,-h,f*-e-h,!0),i.stroke(),u++,u<110&&window.requestAnimationFrame(function(){n(u/100)})}function o(){i.fillRect(0,0,a.width,a.width)}var i,a=this,s=e(this),l=a.width/2,r=7,c=1,d=l-r,u=0,f=2*Math.PI,h=Math.PI/2,p=(new Date).getTime()+"CA";s.is("canvas")&&(i=a.getContext("2d"),i.strokeStyle="#0d263c",i.fillStyle="#e5e8e8",s.attr("circle-animation-id",p),e("body").delegate("[circle-animation-id="+p+"]","startAnimate",function(){u=0,n()}),e("body").delegate("[circle-animation-id="+p+"]","clearAnimate",o))}),this}}(jQuery),function(e){e.fn.blockLink=function(){return this.each(function(){function t(){o.on("click",n)}function n(){location=i}var o=e(this),i=o.find("a").attr("href");t()}),this}}(jQuery),function(e){function t(){a=new o,i=new n(a),window.location.pathname.indexOf("/fr/")!==-1&&e("body").addClass("fr"),e('a[href^="#"]').on("click",function(t){var n=e(this.getAttribute("href"));n.length&&(t.preventDefault(),e("html, body").stop().animate({scrollTop:n.offset().top+52},750)),"#"!==n.selector&&(e("#main-menu-anchor").css({display:"none"}),e("body").removeClass("is-reveal-open branded"))}),e(".menu-icon").on("click",function(t){e("body").addClass("is-reveal-open branded")}),e(".top-bar .close-button.show-for-small-only").on("click",function(){e("#main-menu-anchor").css({display:"none"}),e("body").removeClass("is-reveal-open branded")}),e(window).resize(function(){e(window).width()>640&&e("body").removeClass("branded")})}function n(t){function n(){o(),e(".block-link").blockLink(),v=e(".our-business-slider"),e("#edge-overlay-content").find(".carousel-next").on("click",function(e){e.preventDefault(),v.slick("slickNext")}),e(".video-slide.slick-active").length?(e(".slick-list.draggable").css({height:"660px"}),e(".section.profiles-slider").css({backgroundColor:"#e5e8e8"})):(e(".slick-list.draggable").css({height:"auto"}),e(".section.profiles-slider").css({backgroundColor:"#7ec4b9"})),e(".profile-counter").each(function(){var t=e(this);t.find("canvas").circleAnimation(parseInt(t.find("p").html()))}),m=e(".profiles-slider"),e(window).on("hashchange",r),r(),e(window).on("resize",s),f(!0),e(window).on("scroll",l),h(),e(".info-toggle").infoToggle(),e(".top-bar + .screen").on("click",function(){e("a[data-toggle]").trigger("click")}),e(".share-toggle-trigger").on("click",function(t){t.preventDefault(),e(".info-toggle").addClass("active")}),e(".share-toggle-close").on("click",function(t){t.stopPropagation(),t.preventDefault(),e(".info-toggle").toggleClass("active")})}function o(){e("body").delegate(y,"click",function(){var t=e(this),n=t.attr("class").match(/toggle-(\S*)?($|\s)/)[1],o=t.parents($);o.find(y).removeClass("active"),o.find(C).removeClass("active"),t.addClass("active"),o.find(".content-"+n).addClass("active")})}function i(){var t,n=0;A&&(m.find(".slick-slide").removeClass("slick-complete"),m.find(".slick-active").addClass("slick-complete"),m.find(".slick-slide:not(.slick-complete)").find(".profile-counter canvas").trigger("clearAnimate"),m.find(".slick-complete").find(".profile-counter canvas").trigger("startAnimate"),m.find(".slick-active").is("[class*=profile-]")||S?m.addClass("contrast-arrow"):m.removeClass("contrast-arrow"),t=m.find(".profile-1-slide, .profile-2-slide"),t.css({height:"auto"}),t.each(function(){var t=e(this).outerHeight();t>n&&(n=t)}),t.css({height:n}))}function a(e,t){e.slick("slickSetOption","accessibility",t),e.slick("slickSetOption","draggable",t),e.slick("slickSetOption","swipe",t),e.slick("slickSetOption","touchMove",t)}function s(){w&&window.clearTimeout(w),w=window.setTimeout(f,250)}function l(){k&&window.clearTimeout(k),k=window.setTimeout(h,250)}function r(e){var t="#our-edge-";b||0!==location.hash.indexOf(t)||x.openOverlay(T,c,d,!0)}function c(t){var n;g(v,{dots:!1,slidesToShow:1,slidesToScroll:1}),n=v.find("."+location.hash.replace("#our-","")+":not(.slick-cloned)").attr("data-slick-index"),v.slick("slickGoTo",n,!0),v.on("afterChange",u),u(null,null,parseInt(e("#modalOverlay .slick-active").attr("data-slick-index"))),f(),b=!0}function d(t){var n,o=e("#modalOverlay > div");v.slick("unslick"),v.off("afterChange"),e(".overlay-repository").append(o),"pushState"in history?history.pushState("",document.title,location.pathname+location.search):(n=e(document).scrollTop(),location.hash="",e(document).scrollTop(n)),b=!1}function u(t,n,o){var i=(o+1)%(e(".slick-slide:not(.slick-cloned)").length-1),a=e(v.find("[data-slick-index="+i+"] .columns:first-child p").get(0)).html(),s="our-"+v.find("[data-slick-index="+o+"]").attr("class").match(/(edge-\S*)/)[1];e("#modalOverlay .carousel-next a").html(a),location.hash=s}function f(t){var n=e(window).width(),o=0,i=n<o;v.is(".slick-initialized")&&a(v,!i),S!==i?S=i:t&&p()}function h(){A||e(window).scrollTop()+e(window).height()>m.offset().top&&(A=!0,window.setTimeout(i,500))}function p(){g(m,{dots:!0,slidesToShow:1,slidesToScroll:1,adaptiveHeight:!0,prevArrow:'<span type="button" class="carousel-prev"><img src="images/Arrow-MainArticle-Carousel-Black-L.svg"></span>',nextArrow:'<span type="button" class="carousel-next"><img src="images/Arrow-MainArticle-Carousel-Black-R.svg"></span>'}),i(),m.on("afterChange",i)}function g(t,n){var o={speed:750,dots:!0,slidesToShow:2,slidesToScroll:2,infinite:!0,responsive:[{breakpoint:768,settings:{slidesToShow:1,slidesToScroll:1,infinite:!0}}]};t.slick(e.extend(o,n))}var v,m,w,k,b,y='[class*="toggle-"]:not([class*="info-toggle"])',C='[class*="content-"]',$=".multi-tab-outline",T=e("#edge-overlay-content"),x=t,S=(e("<div></div>"),!1),A=!1;n()}function o(){function t(){f=e("<div></div>"),f.attr("id","modalOverlay"),f.attr("class","reveal"),f.attr("data-reveal",!0),g.append(f),f.on("open.zf.reveal",i),e(window).on("closed.zf.reveal",o),e(window).on("resize",n),a(),new Foundation.Reveal(f)}function n(){h&&window.clearTimeout(h),h=window.setTimeout(u,250)}function o(e){m=!1,v.close&&v.close(e),d(),v={}}function i(t){t.preventDefault(),m=!0,e("body").addClass("is-reveal-open"),f.find("*").foundation(),v.open&&v.open(t),u()}function a(){var t=e("<span></span>");p=e("<button data-close></button>"),p.addClass("close-button"),p.attr("aria-label","Close modal"),t.attr("aria-hidden",!0),t.html("&times;"),p.append(t)}function s(){return m}function l(e,t,n,o){v.open=t,v.close=n,v.full=o,"string"==typeof e?r(e):c(e)}function r(t){e.ajax(t).done(c)}function c(e){f.html(e),f.append(p),v.full&&f.addClass("full"),f.foundation("open")}function d(){f.removeClass("full"),f.removeClass("tour"),f.html("")}function u(){var t=f.height(),n=e(window).height();t>n&&(f.css({top:0}),f.addClass("full"))}var f,h,p,g=e("body"),v={},m=!1;return t(),{openOverlay:l,isOpen:s}}var i,a;t()}(jQuery)}return{init:e}}(),i=function(){function e(){t()}function t(){function e(e){e.searchtype="office",e.name="",$(".zero-results").addClass("hide"),$.getJSON(o,e).always().done(function(e){var t=JSON.parse(e);t.length?($("body").addClass("is-reveal-open"),$("#searchResultsModal").removeClass("closed").html(""),n("office-template",t)):$(".zero-results").removeClass("hide")}).fail(function(e){console.log("Data could not be retrieved, please try again",e.status+" "+e.statusText)})}function t(){var e={},t=i.val();e.city="",e.lang=a,e.searchtype="con";for(var n=t.split(" "),o=0;o<n.length;o++){var l=s.locations.get(n[o]);l.length>0&&(e.city=l[0],n.splice(o,1))}return e.city||(e.city=n.join(" ")),e}function n(e,t){var n=document.getElementById(e).innerHTML;Mustache.parse(n);var o=Mustache.render(n,t);$("#searchResultsModal").append(o),$(document).foundation()}var o="https://search.investorsgroup.com/api/cwpsearch?",i=$("#FindAnOffice"),a="en";window.location.href.indexOf("/fr/")>-1&&(a="fr");var s={};s.locations=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"data/cities.json"}),$(function(){$(".typeahead").typeahead({highlight:!0},{name:"locations",source:s.locations,limit:2}),$(".ig-search").submit(function(n){n.preventDefault();var o=t();e(o)}),$(document).on("click","#searchResultsModal .close-button",function(){$("#searchResultsModal").addClass("closed"),setTimeout(function(){$("body").removeClass("is-reveal-open")},400)})})}return{init:e}}(),a=function(){function a(){$(document).foundation(),$(".ig-form").length&&t.init(),$(".ig-carousel").length&&n.init(),$(".ig-search").length&&i.init(),$(".ig-careers").length&&o.init(),$(".ig-video-group").length&&video.init(),s()}function s(){$("body").addClass(e)}return{init:a}}();$(document).ready(function(){a.init()})}();